{"version":3,"file":"print.9fd8be4b8fc330c569c6.js","mappings":"uBAAIA,E,kBCQG,SAASC,EAAiBC,EAA2BC,EAAYC,GAEtE,MAAMC,EAAkBF,EAAKC,EAC7B,IAAIE,EAiBJ,OAfID,EAAkB,GAEpBC,EAAW,CAACJ,EAAOK,MAAOL,EAAOK,MAAQF,GACrCC,EAAS,GAAKJ,EAAOM,SACvBF,EAAW,CAACJ,EAAOM,OAASH,EAAiBH,EAAOM,WAKtDF,EAAW,CAACJ,EAAOM,OAASH,EAAiBH,EAAOM,QAChDF,EAAS,GAAKJ,EAAOK,QACvBD,EAAW,CAACJ,EAAOK,MAAOL,EAAOK,MAAQF,KAItC,CACLI,QAAS,CAACH,EAAS,GAAKJ,EAAOK,MAAOD,EAAS,GAAKJ,EAAOM,QAC3DD,MAAOD,EAAS,GAChBE,OAAQF,EAAS,GACjBI,SAAUR,EAAOK,MAAQD,EAAS,IAAM,EACxCK,SAAUT,EAAOM,OAASF,EAAS,IAAM,EAE7C,C,oCCjCA,IAAIM,EAA2B,KAgBxB,MAAMC,EAIXC,WAAAA,CAAoBC,GAAoD,KAApDA,GAAAA,EAClB,MAAMC,EAAgBC,KAAKC,oBAE3BD,KAAKE,YAAc,CACjBC,QAASJ,EACTK,gBAAiB,CACfC,eAAgBP,EAAGQ,kBAAkBP,EAAe,oBAEtDQ,iBAAkB,CAChBC,SAAUV,EAAGW,mBACTV,EACA,cAKRC,KAAKU,eAAiBZ,EAAGa,eAGzBb,EAAGc,WAAWd,EAAGe,aAAcb,KAAKU,gBACpCZ,EAAGgB,WAAWhB,EAAGe,aAAc,IAAIE,aAHjB,CAAC,EAAK,GAAM,EAAK,EAAK,GAAM,GAAM,GAAM,IAGEjB,EAAGkB,YACjE,CAEAC,qBAAAA,GACE,MAAQ,uNAOV,CAEAC,uBAAAA,GACE,MAAQ,gHAMV,CAKQjB,iBAAAA,GACN,MAAMH,EAAKE,KAAKF,GACVqB,EAAWnB,KAAKiB,wBAChBG,EAAWpB,KAAKkB,0BAChBG,EAAezB,EAAW0B,WAAWxB,EAAIA,EAAGyB,cAAeJ,GAC7DK,EAAiB5B,EAAW0B,WAAWxB,EAAIA,EAAG2B,gBAAiBL,GAC/DrB,EAAgBD,EAAG4B,gBAQvB,GANA5B,EAAG6B,aAAa5B,EAAesB,GAC/BvB,EAAG6B,aAAa5B,EAAeyB,GAC/B1B,EAAG8B,YAAY7B,IAIVD,EAAG+B,oBAAoB9B,EAAeD,EAAGgC,aAC5C,MAAM,IAAIC,MACL,4CAA2CjC,EAAGkC,kBAC3CjC,MAKV,OAAOA,CACT,CAOAkC,QAAAA,CAASzC,GACP,MAAMM,EAAKE,KAAKF,GACVI,EAAcF,KAAKE,YAEzBJ,EAAGoC,OAAOpC,EAAGqC,OAEbrC,EAAGc,WAAWd,EAAGe,aAAcb,KAAKU,gBACpCZ,EAAGsC,oBACClC,EAAYE,gBAAgBC,eAC5B,EACAP,EAAGuC,OACH,EACA,EACA,GAEJvC,EAAGwC,wBAAwBpC,EAAYE,gBAAgBC,gBACvDP,EAAGyC,WAAWrC,EAAYC,SAI1BL,EAAGoC,OAAOpC,EAAG0C,cACb1C,EAAG2C,YACC3C,EAAG4C,OACH,EACA,KAEJ5C,EAAG6C,UACC7C,EAAG8C,KACH9C,EAAG8C,KACH9C,EAAG+C,SAEP/C,EAAGgD,WACC5C,EAAYK,iBAAiBC,SAC7BhB,GAEJM,EAAGiD,UAAUjD,EAAGkD,KAAMlD,EAAGmD,KACzBnD,EAAGoD,WAAWpD,EAAGqD,eAAgB,EAAG,GAIpCrD,EAAG2C,YACC3C,EAAGsD,MACH,EACA,KAEJtD,EAAG6C,UACC7C,EAAG8C,KACH9C,EAAG8C,KACH9C,EAAG8C,MAEP9C,EAAGgD,WACC5C,EAAYK,iBAAiBC,SAC7B,CAAC,EAAG,IAERV,EAAGiD,UAAUjD,EAAGkD,KAAMlD,EAAGuD,WACzBvD,EAAGoD,WAAWpD,EAAGqD,eAAgB,EAAG,EACtC,CAMA,iBAAe7B,CAAWxB,EAAoDwD,EAAcC,GAC1F,MAAMC,EAAS1D,EAAG2D,aAAaH,GAK/B,GAHAxD,EAAG4D,aAAaF,EAAQD,GACxBzD,EAAG6D,cAAcH,IAEZ1D,EAAG8D,mBAAmBJ,EAAQ1D,EAAG+D,gBACpC,MAAM,IAAI9B,MACL,4CAA2CjC,EAAGgE,iBAAiBN,MAKtE,OAAOA,CACT,EAMK,SAASO,EAAaC,EAAcC,GACzC,MAAMhF,EAAS+E,EAAM/E,OACfiF,EAAMjF,EAAOkF,WAAW,WAAalF,EAAOkF,WAAW,SAE7D,GAAIF,GACF,IAAKtE,EAAgB,CACnB,MAAMyE,EAAS,IAAIxE,EAAWsE,GAC9BvE,EAAiBqE,EAAMK,WAAWC,kBAAiB,KACjDF,EAAOnC,SAASgC,IAAc,GAElC,OAEOtE,IACPA,IAEAA,EAAiB,MAEnBqE,EAAMO,eACR,CC1LO,SAASC,EAAeR,EAAcS,GAC3C,OAAO,IAAIC,SAAQ,CAACC,EAASC,KAE3B,MAAMC,EAAUb,EAAMK,WAAWC,kBAAiB,KAChDO,IACA,IACE,IAAIC,EAEJ,GAAIL,EAAS,CACX,MAAMM,EAAgBC,SAASC,cAAc,UAE7CF,EAAczF,MAAQmF,EAAQnF,MAC9ByF,EAAcxF,OAASkF,EAAQlF,OAC/BwF,EAAcZ,WAAW,MAAMe,UAC3BlB,EAAM/E,OACNwF,EAAQhF,QAASgF,EAAQ/E,QAAS+E,EAAQnF,MAAOmF,EAAQlF,OACzD,EAAG,EAAGkF,EAAQnF,MAAOmF,EAAQlF,QACjCuF,EAAMC,EAAcI,WACtB,MAEEL,EAAMd,EAAM/E,OAAOkG,YAErBR,EAAQG,EACV,CACA,MAAOM,GACLR,EAAOQ,EACT,KAGFpB,EAAMO,eAAe,GAEzB,C,oGChCAc,OAAOC,IAAIC,mBAAqB,IAChC,MAAMC,EAAO,IAAI,IAAM,CACrBC,OAAQ,CACN,IAAI,IAAY,CACdlC,OAAQ,IAAI,OAGhBmC,UAAU,OAAkB,CAC1BC,mBAAoB,CAClBC,aAAa,KAGjBC,OAAQ,MACRC,KAAM,IAAI,KAAO,CACfC,QAAQ,QAAU,CAAC,GAAI,IAAK,YAAa,aACzCC,KAAM,MAIJC,EAAO,IAAI,KAAS,CACxBC,IAAKV,IAEDxB,EAAQiC,EAAKE,iBAQnB,SAASC,IACP,MAAMC,EAAarB,SAASsB,cAAc,eAAeC,MACnDtH,EAAS+E,EAAM/E,OACfuH,EAAIC,KAAKC,IAAIzH,EAAOK,MAAOL,EAAOM,QACxC,MACO,aADC8G,GAEG,QAAiBpH,EAAQuH,EAAI,EAAGA,EAAI,IAEpC,QAAiBvH,EAAQuH,EAAI,EAAGA,EAAI,EAEjD,CAjBAnB,OAAOsB,0BAA0BC,MAAKC,GAAM7C,EAAM8C,gBAAkBD,IACpEZ,EAAKc,YAAW,GAGhB/B,SAASgC,eAAe,UAAU1C,iBAAiB,SAAS,IAAM2B,EAAKc,YAAYd,EAAKgB,gBACxFjC,SAASgC,eAAe,mBAAmB1C,iBAAiB,UAAU4C,GAAOjB,EAAKkB,mBAAmBC,OAAOC,WAAWH,EAAIrB,OAAOU,WAalI,QAAavC,GAAO,IAAMoC,IAAiB5G,UAE3C8H,OAAuB,eAAIC,iBACzB,MAAMC,EAAIpB,IAEJG,QAAc,QAAevC,EAAOwD,GACpCC,EAAM,IAAIC,MAIVzI,EAAS+E,EAAM/E,OACrBwI,EAAIE,IAAMpB,EACVkB,EAAInI,MAAQkI,EAAElI,OAASL,EAAOK,MAAQL,EAAO2I,aAC7CH,EAAIlI,OAASiI,EAAEjI,QAAUN,EAAOM,OAASN,EAAO4I,cAChD7C,SAAS8C,KAAKC,OAAON,EACvB,C,GCjEIO,EAA2B,CAAC,EAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUM,KAAKF,EAAOD,QAASC,EAAQA,EAAOD,QAASJ,GAGpEK,EAAOD,OACf,CAGAJ,EAAoBQ,EAAIF,ELzBpBxJ,EAAW,GACfkJ,EAAoBS,EAAI,CAACC,EAAQC,EAAUC,EAAIC,KAC9C,IAAGF,EAAH,CAMA,IAAIG,EAAeC,IACnB,IAASC,EAAI,EAAGA,EAAIlK,EAASmK,OAAQD,IAAK,CAGzC,IAFA,IAAKL,EAAUC,EAAIC,GAAY/J,EAASkK,GACpCE,GAAY,EACPC,EAAI,EAAGA,EAAIR,EAASM,OAAQE,MACpB,EAAXN,GAAsBC,GAAgBD,IAAaO,OAAOC,KAAKrB,EAAoBS,GAAGa,OAAOC,GAASvB,EAAoBS,EAAEc,GAAKZ,EAASQ,MAC9IR,EAASa,OAAOL,IAAK,IAErBD,GAAY,EACTL,EAAWC,IAAcA,EAAeD,IAG7C,GAAGK,EAAW,CACbpK,EAAS0K,OAAOR,IAAK,GACrB,IAAIzB,EAAIqB,SACET,IAANZ,IAAiBmB,EAASnB,EAC/B,CACD,CACA,OAAOmB,CAnBP,CAJCG,EAAWA,GAAY,EACvB,IAAI,IAAIG,EAAIlK,EAASmK,OAAQD,EAAI,GAAKlK,EAASkK,EAAI,GAAG,GAAKH,EAAUG,IAAKlK,EAASkK,GAAKlK,EAASkK,EAAI,GACrGlK,EAASkK,GAAK,CAACL,EAAUC,EAAIC,EAqBjB,EMzBdb,EAAoByB,EAAI,CAACrB,EAASsB,KACjC,IAAI,IAAIH,KAAOG,EACX1B,EAAoB2B,EAAED,EAAYH,KAASvB,EAAoB2B,EAAEvB,EAASmB,IAC5EH,OAAOQ,eAAexB,EAASmB,EAAK,CAAEM,YAAY,EAAMC,IAAKJ,EAAWH,IAE1E,ECNDvB,EAAoB2B,EAAI,CAACI,EAAKC,IAAUZ,OAAOa,UAAUC,eAAe3B,KAAKwB,EAAKC,GCClFhC,EAAoBT,EAAKa,IACH,oBAAX+B,QAA0BA,OAAOC,aAC1ChB,OAAOQ,eAAexB,EAAS+B,OAAOC,YAAa,CAAE9D,MAAO,WAE7D8C,OAAOQ,eAAexB,EAAS,aAAc,CAAE9B,OAAO,GAAO,ECL9D0B,EAAoBmB,EAAI,I,MCKxB,IAAIkB,EAAkB,CACrB,IAAK,GAaNrC,EAAoBS,EAAEU,EAAKmB,GAA0C,IAA7BD,EAAgBC,GAGxD,IAAIC,EAAuB,CAACC,EAA4BC,KACvD,IAGIxC,EAAUqC,GAHT3B,EAAU+B,EAAaC,GAAWF,EAGhBzB,EAAI,EAC3B,GAAGL,EAASiC,MAAMC,GAAgC,IAAxBR,EAAgBQ,KAAa,CACtD,IAAI5C,KAAYyC,EACZ1C,EAAoB2B,EAAEe,EAAazC,KACrCD,EAAoBQ,EAAEP,GAAYyC,EAAYzC,IAGhD,GAAG0C,EAAS,IAAIjC,EAASiC,EAAQ3C,EAClC,CAEA,IADGwC,GAA4BA,EAA2BC,GACrDzB,EAAIL,EAASM,OAAQD,IACzBsB,EAAU3B,EAASK,GAChBhB,EAAoB2B,EAAEU,EAAiBC,IAAYD,EAAgBC,IACrED,EAAgBC,GAAS,KAE1BD,EAAgBC,GAAW,EAE5B,OAAOtC,EAAoBS,EAAEC,EAAO,EAGjCoC,EAAqBC,KAA4B,sBAAIA,KAA4B,uBAAK,GAC1FD,EAAmBE,QAAQT,EAAqBU,KAAK,KAAM,IAC3DH,EAAmBI,KAAOX,EAAqBU,KAAK,KAAMH,EAAmBI,KAAKD,KAAKH,G,KC7CvF,IAAIK,EAAsBnD,EAAoBS,OAAEN,EAAW,CAAC,MAAM,IAAOH,EAAoB,QAC7FmD,EAAsBnD,EAAoBS,EAAE0C,E","sources":["webpack://ol-cesium/webpack/runtime/chunk loaded","webpack://ol-cesium/./src/olcs/print/computeRectangle.ts","webpack://ol-cesium/./src/olcs/print/drawCesiumMask.ts","webpack://ol-cesium/./src/olcs/print/takeCesiumScreenshot.ts","webpack://ol-cesium/./examples/print.js","webpack://ol-cesium/webpack/bootstrap","webpack://ol-cesium/webpack/runtime/define property getters","webpack://ol-cesium/webpack/runtime/hasOwnProperty shorthand","webpack://ol-cesium/webpack/runtime/make namespace object","webpack://ol-cesium/webpack/runtime/runtimeId","webpack://ol-cesium/webpack/runtime/jsonp chunk loading","webpack://ol-cesium/webpack/startup"],"sourcesContent":["var deferred = [];\n__webpack_require__.O = (result, chunkIds, fn, priority) => {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar [chunkIds, fn, priority] = deferred[i];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every((key) => (__webpack_require__.O[key](chunkIds[j])))) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","export interface RectangleOutput {\n  scaling: [number, number];\n  offsetX: number;\n  offsetY: number;\n  width: number;\n  height: number;\n}\n\nexport function computeRectangle(canvas: HTMLCanvasElement, tw: number, th: number): RectangleOutput {\n\n  const maskAspectRatio = tw / th;\n  let maskSize;\n\n  if (maskAspectRatio > 1) {\n    // landscape\n    maskSize = [canvas.width, canvas.width / maskAspectRatio];\n    if (maskSize[1] > canvas.height) {\n      maskSize = [canvas.height * maskAspectRatio, canvas.height];\n    }\n  }\n  else {\n    // portrait\n    maskSize = [canvas.height * maskAspectRatio, canvas.height];\n    if (maskSize[0] > canvas.width) {\n      maskSize = [canvas.width, canvas.width / maskAspectRatio];\n    }\n  }\n\n  return {\n    scaling: [maskSize[0] / canvas.width, maskSize[1] / canvas.height],\n    width: maskSize[0],\n    height: maskSize[1],\n    offsetX: (canvas.width - maskSize[0]) / 2,\n    offsetY: (canvas.height - maskSize[1]) / 2,\n  };\n}\n","import type {Scene} from 'cesium';\n\nlet postUnlistener: Function = null;\n\ninterface ProgramInfo {\n  program: WebGLProgram,\n  attribLocations: {\n    vertexPosition: number\n  },\n  uniformLocations: {\n    uScaling: WebGLUniformLocation\n  }\n}\n\n\n// CC0 from https://github.com/mdn/dom-examples/tree/main/webgl-examples/tutorial/sample2\n\n\nexport class MaskDrawer {\n  private programInfo: ProgramInfo;\n  private positionBuffer: WebGLBuffer;\n\n  constructor(private gl: WebGL2RenderingContext | WebGLRenderingContext) {\n    const shaderProgram = this.initShaderProgram();\n\n    this.programInfo = {\n      program: shaderProgram,\n      attribLocations: {\n        vertexPosition: gl.getAttribLocation(shaderProgram, 'aVertexPosition')\n      },\n      uniformLocations: {\n        uScaling: gl.getUniformLocation(\n            shaderProgram,\n            'uScaling'\n        )\n      }\n    };\n\n    this.positionBuffer = gl.createBuffer();\n    const positions = [1.0, 1.0, -1.0, 1.0, 1.0, -1.0, -1.0, -1.0];\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(positions), gl.STATIC_DRAW);\n  }\n\n  getVertexShaderSource() {\n    return `\n      attribute vec4 aVertexPosition;\n      uniform vec2 uScaling;\n      void main() {\n        gl_Position = vec4(aVertexPosition[0] * uScaling[0], aVertexPosition[1] * uScaling[1], -1.0, 1.0);\n      }\n    `;\n  }\n\n  getFragmentShaderSource() {\n    return `\n      precision highp float;\n      void main() {\n        gl_FragColor = vec4(.5, .5, .5, .6);\n      }\n  `;\n  }\n\n  /**\n   *\n   */\n  private initShaderProgram(): WebGLProgram {\n    const gl = this.gl;\n    const vsSource = this.getVertexShaderSource();\n    const fsSource = this.getFragmentShaderSource();\n    const vertexShader = MaskDrawer.loadShader(gl, gl.VERTEX_SHADER, vsSource),\n        fragmentShader = MaskDrawer.loadShader(gl, gl.FRAGMENT_SHADER, fsSource),\n        shaderProgram = gl.createProgram();\n\n    gl.attachShader(shaderProgram, vertexShader);\n    gl.attachShader(shaderProgram, fragmentShader);\n    gl.linkProgram(shaderProgram);\n\n    // If creating the shader program failed, alert\n\n    if (!gl.getProgramParameter(shaderProgram, gl.LINK_STATUS)) {\n      throw new Error(\n          `Unable to initialize the shader program: ${gl.getProgramInfoLog(\n              shaderProgram\n          )}`\n      );\n    }\n\n    return shaderProgram;\n  }\n\n\n  /**\n   *\n   * @param {number[]} scaling scaling\n   */\n  drawMask(scaling: number[]) {\n    const gl = this.gl;\n    const programInfo = this.programInfo;\n    // Blend\n    gl.enable(gl.BLEND);\n\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n    gl.vertexAttribPointer(\n        programInfo.attribLocations.vertexPosition,\n        2,\n        gl.FLOAT,\n        false,\n        0,\n        0\n    );\n    gl.enableVertexAttribArray(programInfo.attribLocations.vertexPosition);\n    gl.useProgram(programInfo.program);\n\n\n    // Draw a first time to fill the stencil area while keeping the destination color\n    gl.enable(gl.STENCIL_TEST);\n    gl.stencilFunc(\n        gl.ALWAYS,\n        1,\n        0xFF\n    );\n    gl.stencilOp(\n        gl.KEEP,\n        gl.KEEP,\n        gl.REPLACE\n    );\n    gl.uniform2fv(\n        programInfo.uniformLocations.uScaling,\n        scaling\n    );\n    gl.blendFunc(gl.ZERO, gl.ONE);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n\n\n    // Now draw again the whole viewport and darken the pixels that are not on the stencil\n    gl.stencilFunc(\n        gl.EQUAL,\n        0,\n        0xFF\n    );\n    gl.stencilOp(\n        gl.KEEP,\n        gl.KEEP,\n        gl.KEEP\n    );\n    gl.uniform2fv(\n        programInfo.uniformLocations.uScaling,\n        [1, 1]\n    );\n    gl.blendFunc(gl.ZERO, gl.SRC_ALPHA);\n    gl.drawArrays(gl.TRIANGLE_STRIP, 0, 4);\n  }\n\n\n\n  /**\n   */\n  private static loadShader(gl: WebGL2RenderingContext | WebGLRenderingContext, type: number, source: string): WebGLShader {\n    const shader = gl.createShader(type);\n\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      throw new Error(\n          `An error occurred compiling the shaders: ${gl.getShaderInfoLog(shader)}`\n      );\n      // gl.deleteShader(shader);\n    }\n\n    return shader;\n  }\n}\n\n/**\n *\n */\nexport function autoDrawMask(scene: Scene, getScalings: () => number[]) {\n  const canvas = scene.canvas;\n  const ctx = canvas.getContext('webgl2') || canvas.getContext('webgl');\n\n  if (getScalings) {\n    if (!postUnlistener) {\n      const drawer = new MaskDrawer(ctx);\n      postUnlistener = scene.postRender.addEventListener(() => {\n        drawer.drawMask(getScalings());\n      });\n    }\n  }\n  else if (postUnlistener) {\n    postUnlistener();\n    // FIXME: destroy program\n    postUnlistener = null;\n  }\n  scene.requestRender();\n}\n","import type {Scene} from 'cesium';\n\ninterface ScreenshotOptions {\n  offsetX: number;\n  offsetY: number;\n  width: number;\n  height: number;\n}\n\n/**\n */\nexport function takeScreenshot(scene: Scene, options: ScreenshotOptions): Promise<string> {\n  return new Promise((resolve, reject) => {\n  // preserveDrawingBuffers is false so we render on demand and immediately read the buffer\n    const remover = scene.postRender.addEventListener(() => {\n      remover();\n      try {\n        let url;\n\n        if (options) {\n          const smallerCanvas = document.createElement('canvas');\n\n          smallerCanvas.width = options.width;\n          smallerCanvas.height = options.height;\n          smallerCanvas.getContext('2d').drawImage(\n              scene.canvas,\n              options.offsetX, options.offsetY, options.width, options.height,\n              0, 0, options.width, options.height);\n          url = smallerCanvas.toDataURL();\n        }\n        else {\n          url = scene.canvas.toDataURL();\n        }\n        resolve(url);\n      }\n      catch (e) {\n        reject(e);\n      }\n    });\n\n    scene.requestRender();\n  });\n}\n","import OLCesium, {takeScreenshot, autoDrawMask, computeRectangle} from 'olcs';\nimport {transform} from 'ol/proj.js';\nimport olView from 'ol/View.js';\nimport {defaults as olControlDefaults} from 'ol/control.js';\nimport olSourceOSM from 'ol/source/OSM.js';\nimport olLayerTile from 'ol/layer/Tile.js';\nimport olMap from 'ol/Map.js';\nimport {OLCS_ION_TOKEN} from './_common.js';\n\n\nCesium.Ion.defaultAccessToken = OLCS_ION_TOKEN;\nconst ol2d = new olMap({\n  layers: [\n    new olLayerTile({\n      source: new olSourceOSM()\n    })\n  ],\n  controls: olControlDefaults({\n    attributionOptions: {\n      collapsible: false\n    }\n  }),\n  target: 'map',\n  view: new olView({\n    center: transform([25, 20], 'EPSG:4326', 'EPSG:3857'),\n    zoom: 3\n  })\n});\n\nconst ol3d = new OLCesium({\n  map: ol2d,\n});\nconst scene = ol3d.getCesiumScene();\nCesium.createWorldTerrainAsync().then(tp => scene.terrainProvider = tp);\nol3d.setEnabled(true);\n\n\ndocument.getElementById('enable').addEventListener('click', () => ol3d.setEnabled(!ol3d.getEnabled()));\ndocument.getElementById('resolutionScale').addEventListener('change', evt => ol3d.setResolutionScale(Number.parseFloat(evt.target.value)));\n\nfunction scalingOptions() {\n  const printValue = document.querySelector('#printValue').value;\n  const canvas = scene.canvas;\n  const v = Math.min(canvas.width, canvas.height);\n  switch (printValue) {\n    case 'portrait':\n      return computeRectangle(canvas, v / 4, v / 2);\n    default:\n      return computeRectangle(canvas, v / 2, v / 4);\n  }\n}\nautoDrawMask(scene, () => scalingOptions().scaling);\n\nwindow['takeScreenshot'] = async function() {\n  const r = scalingOptions();\n  console.log(r);\n  const value = await takeScreenshot(scene, r);\n  const img = new Image();\n  /**\n   * @type {HTMLCanvasElement}\n   */\n  const canvas = scene.canvas;\n  img.src = value;\n  img.width = r.width / (canvas.width / canvas.clientWidth);\n  img.height = r.height / (canvas.height / canvas.clientHeight);\n  document.body.append(img);\n};\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","__webpack_require__.j = 740;","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t740: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = (chunkId) => (installedChunks[chunkId] === 0);\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = (parentChunkLoadingFunction, data) => {\n\tvar [chunkIds, moreModules, runtime] = data;\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some((id) => (installedChunks[id] !== 0))) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkol_cesium\"] = self[\"webpackChunkol_cesium\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [351], () => (__webpack_require__(3558)))\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["deferred","computeRectangle","canvas","tw","th","maskAspectRatio","maskSize","width","height","scaling","offsetX","offsetY","postUnlistener","MaskDrawer","constructor","gl","shaderProgram","this","initShaderProgram","programInfo","program","attribLocations","vertexPosition","getAttribLocation","uniformLocations","uScaling","getUniformLocation","positionBuffer","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","getVertexShaderSource","getFragmentShaderSource","vsSource","fsSource","vertexShader","loadShader","VERTEX_SHADER","fragmentShader","FRAGMENT_SHADER","createProgram","attachShader","linkProgram","getProgramParameter","LINK_STATUS","Error","getProgramInfoLog","drawMask","enable","BLEND","vertexAttribPointer","FLOAT","enableVertexAttribArray","useProgram","STENCIL_TEST","stencilFunc","ALWAYS","stencilOp","KEEP","REPLACE","uniform2fv","blendFunc","ZERO","ONE","drawArrays","TRIANGLE_STRIP","EQUAL","SRC_ALPHA","type","source","shader","createShader","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","autoDrawMask","scene","getScalings","ctx","getContext","drawer","postRender","addEventListener","requestRender","takeScreenshot","options","Promise","resolve","reject","remover","url","smallerCanvas","document","createElement","drawImage","toDataURL","e","Cesium","Ion","defaultAccessToken","ol2d","layers","controls","attributionOptions","collapsible","target","view","center","zoom","ol3d","map","getCesiumScene","scalingOptions","printValue","querySelector","value","v","Math","min","createWorldTerrainAsync","then","tp","terrainProvider","setEnabled","getElementById","getEnabled","evt","setResolutionScale","Number","parseFloat","window","async","r","img","Image","src","clientWidth","clientHeight","body","append","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call","m","O","result","chunkIds","fn","priority","notFulfilled","Infinity","i","length","fulfilled","j","Object","keys","every","key","splice","d","definition","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","data","moreModules","runtime","some","id","chunkLoadingGlobal","self","forEach","bind","push","__webpack_exports__"],"sourceRoot":""}